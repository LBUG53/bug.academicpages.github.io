<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>An endowment is not a piggy bank</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./assets/styles.css?v=optA6" />
  <noscript>
    <style>body{padding:12px;color:#e5e7eb;background:#0b1020}</style>
    <div>JavaScript is disabled. The visualization requires JS to run.</div>
  </noscript>
</head>
<body>
  <div class="page">
    <header class="header">
    </header>

    <!-- Row A: stock treemap -->
    <section class="row single">
      <div class="card" id="stock-card">

        <div class="preface">
          <p>It seems like every job requires an undergraduate degree now, and the cost to attend college is growing faster than inflation. Why should colleges charge so much for something people need? Why does an institution like Harvard, with a $53 billion endowment, receive so much money from the federal government?</p>
          <p>These are good questions, and with the Trump administration's multi-pronged assault on Harvard, they are increasingly relevant and have become a prominent part of the national conversation. Higher education leaders and their allies have tried to explain the finances of their institutions, but they struggle to make themselves heard. A part of the problem is the way that they try to communicate these complex issues, largely relying on dense text crafted by the CFO and the General Counsel or graphics pulled from their annual financial statements. This is how I explain it to my friends:</p>
          <p>Harvard is the richest university in the world, with over $53 billion in endowment and who knows how much else in property and other assets. This endowment grew out of centuries of philanthropic gifts from donors, who gave money to Harvard with the understanding that it would be used for its intended purpose. Let's say a 19th century railroad magnate wanted Harvard to have someone teach the next generation of railroad leaders. The magnate could give Harvard enough money to cover the cost of a professor of railroads in perpetuity, creating what's called an "endowed position." That money, and the interest on that money, cannot be used for anything other than a professor in railroads. If by the 21st century there aren't any scholars who study railroads, that money sits unused.</p>
          <p>Funds that must be spent on a specific thing or in a specific way are called restricted funds. Most of a college's endowment is restricted. Here is a breakdown of Harvard's endowment, with the unrestricted money in blue.</p>
        </div>

        <div id="stock-treemap"></div>
        <p class="caption">
          Hover tiles for details. <span class="chip chip-blue"></span> Blue = Unrestricted (your fixed share). Gray = donor-restricted purposes.
        </p>

        <!-- TEXT for the second visualization -->
        <div class="post-treemap-intro" style="margin-top:10px;color:#e2e8f0">
          <p>
            OK, so Harvard can’t touch most of the endowment, what about the <strong>$16&nbsp;billion</strong> that is unrestricted?
            Well, Harvard has been around for almost 400 years, and its leaders need to plan far into the future. The students that are here now matter a great deal, but what if small changes now have much greater long-term impact?
          </p>
          <p>
            Play around with the visualization below to get a sense of what happens when Harvard takes money out of the endowment to cover current needs one year and ten years out. The top three buttons address what happens if the Trump administration continues to target Harvard:
            a one-time pay out of $500 million, the loss of federal funding this year, and the permanent loss of federal funding.
          </p>
          <p>
            The other buttons are pressing projects that Harvard has either promised to do, or that it has to do. For example, some Harvard buildings are falling apart, grad students will need higher wages over time, and some of the labs need to be modernized. Finally, the assumptions table lets you play with what happens if Harvard’s investments have a bad year, how much of the payout is already earmarked for current use, and what happens if Congress continues to raise the tax on endowment investment. The table on the right shows how much funding is lost over the course of 10 years when you overspend.
          </p>
          <p>
            For you nerds out there, I lay out the math that drives these visualizations at the bottom of the page.
          </p>
        </div>
      </div>
    </section>

    <!-- Row B: controls + donuts side-by-side (unchanged) -->
    <section class="row">
      <div class="card controls">
        <h2>Scenarios & Options</h2>

        <div class="group">
          <h3>Policy toggles</h3>
          <label><input type="checkbox" id="chkTreasury" /> One-time $500M Treasury payment</label>
          <label><input type="checkbox" id="chkFedOneTime" /> One-time loss of $684M federal research</label>
          <label><input type="checkbox" id="chkFedPermanent" /> Permanent loss of $684M (repeats, grows with inflation)</label>
          <div class="hint">If “Permanent” is ON, the one-time federal loss is ignored to avoid double-counting in year 1.</div>
        </div>

        <div class="group scroll">
          <h3>Additional things to fund</h3>

          <div class="subgroup">
            <h4>One-time (capital)</h4>
            <label><input type="checkbox" id="chkHouse" /> Dorm Renewal phase</label>
            <div class="slider-row">
              <input type="range" id="rngHouse" min="300" max="500" step="10" value="400" />
              <span class="value">$<span id="lblHouse">400</span>M</span>
            </div>

            <label><input type="checkbox" id="chkLabs" /> Modernize wet-labs</label>
            <div class="slider-row">
              <span>Area:</span>
              <input type="range" id="rngLabSF" min="50" max="400" step="10" value="200" />
              <span class="value"><span id="lblLabSF">200</span>k SF</span>
              <span class="muted">(≈ $1,200/SF)</span>
            </div>

            <label><input type="checkbox" id="chkGRF" /> Decarbonization fund top-up (GRF)</label>
            <div class="inline">$37M (one-time)</div>

            <label><input type="checkbox" id="chkGradHousing" /> Graduate housing expansion</label>
            <div class="slider-row">
              <input type="range" id="rngBeds" min="200" max="1200" step="50" value="600" />
              <span class="value"><span id="lblBeds">600</span> beds (~$221k/bed)</span>
            </div>

            <label><input type="checkbox" id="chkLibrary" /> Library renovation (phase)</label>
            <div class="slider-row">
              <input type="range" id="rngLibrary" min="100" max="200" step="10" value="150" />
              <span class="value">$<span id="lblLibrary">150</span>M</span>
            </div>
          </div>

          <div class="subgroup">
            <h4>Recurring (annual)</h4>
            <label><input type="checkbox" id="chkPhD" /> Raise all PhD stipends</label>
            <div class="slider-row">
              <span>+ $</span><input type="range" id="rngPhD" min="0" max="10000" step="500" value="5000" />
              <span class="value"><span id="lblPhD">5000</span> per student</span>
              <span class="muted">(≈4,160 PhDs)</span>
            </div>

            <label><input type="checkbox" id="chkAid" /> Increase undergrad financial aid</label>
            <div class="slider-row">
              <span>+ </span><input type="range" id="rngAid" min="0" max="20" step="1" value="0" />
              <span class="value"><span id="lblAid">0</span>% of $275M/yr</span>
            </div>

            <label><input type="checkbox" id="chkCyber" /> Cybersecurity hardening & insurance</label>
            <div class="slider-row">
              <input type="range" id="rngCyber" min="5" max="10" step="1" value="7" />
              <span class="value">$<span id="lblCyber">7</span>M/yr</span>
            </div>

            <label><input type="checkbox" id="chkDecarbOps" /> Decarbonization operations</label>
            <div class="slider-row">
              <input type="range" id="rngDecarbOps" min="10" max="20" step="1" value="15" />
              <span class="value">$<span id="lblDecarbOps">15</span>M/yr</span>
            </div>

            <label><input type="checkbox" id="chkFacilities" /> Facilities renewal / deferred maintenance</label>
            <div class="slider-row">
              <input type="range" id="rngFacilities" min="50" max="100" step="5" value="75" />
              <span class="value">$<span id="lblFacilities">75</span>M/yr</span>
            </div>
          </div>
        </div>

        <div class="group assumptions">
          <h3>Assumptions</h3>
          <div class="row2">
            <label>Payout rate <input type="number" id="inpPayout" min="3" max="7" step="0.1" value="5.5" />%</label>
            <label>Nominal return (10-yr) <input type="number" id="inpReturn" min="0" max="12" step="0.5" value="7" />%</label>
          </div>
          <div class="row2">
            <label>Inflation on permanent backfill <input type="number" id="inpInfl" min="0" max="6" step="0.1" value="3" />%</label>
            <label>Earmarked for current use <input type="number" id="inpCommitted" min="0" max="100" step="1" value="90" />%</label>
          </div>
          <div class="row2">
            <label>Endowment investment tax <input type="number" id="inpTax" min="0" max="21" step="0.1" value="8" />%</label>
          </div>
        </div>
      </div>

      <div class="card" id="donuts-card">
        <h2>What happens to the unrestricted endowment?</h2>
        <div class="donuts">
          <div class="donut-col">
            <h3>1 Year</h3>
            <svg id="donut1" width="220" height="220"></svg>
            <div class="center-metrics" id="donut1-metrics"></div>
          </div>
          <div class="donut-col">
            <h3>10 Years</h3>
            <svg id="donut10" width="220" height="220"></svg>
            <div class="center-metrics" id="donut10-metrics"></div>
          </div>
        </div>

        <div class="impact">
          <h3>Impact on payout over 10 years</h3>
          <div class="impact-line">
            Baseline (no extras): <strong id="lblPayoutBase">$0</strong>
          </div>
          <div class="impact-line">
            Your scenario (with extras): <strong id="lblPayoutNew">$0</strong>
          </div>
          <div class="impact-line">
            Difference over 10 years: <strong id="lblPayoutDelta">$0</strong>
          </div>

          <h4>Illustrative 10-yr impact across areas (from reduced flexible payout)</h4>
          <ul id="impactList" class="impact-list"></ul>
        </div>

        <p class="caption small">
          Donuts show <strong>real (inflation-adjusted) principal consumed by extra commitments only</strong>. Baseline use of payout for ongoing operations is treated as given. Each year, extra needs are compared to the portfolio’s real after-tax return plus any unused payout. If extras exceed that capacity, the blue wedge grows; the 10-yr donut sums this.
        </p>
      </div>
    </section>

    <!-- Bottom of page: formulas and explanation -->
    <section class="row single" style="margin-top:16px;">
      <div class="card">
        <h2>How the donuts are calculated</h2>
        <div class="caption" style="line-height:1.6">
          <p><strong>Symbols:</strong>
            \(E\)=total endowment, \(u\)=unrestricted share, \(U_0 = E\cdot u\).
            \(p\)=payout rate, \(r_n\)=nominal return, \(\tau\)=investment tax, \(\pi\)=inflation.
            \(c\)=share of payout earmarked for existing operations.
            \(O\)=one-time extras, \(A\)=annual extras, \(F_1\)=permanent federal backfill (year 1 if on).
          </p>

          <p><strong>Real after-tax return:</strong></p>
          \[
            r \;=\; \frac{1 + r_n(1-\tau)}{1+\pi} \;-\; 1
          \]

          <p><strong>Year 1 (incremental-only sustainability):</strong></p>
          \[
            P_0 \;=\; p\,U_0,\quad
            B_0 \;=\; c\,P_0,\quad
            S_0 \;=\; \max(0,\,P_0 - B_0),\quad
            R_0 \;=\; r\,U_0
          \]
          \[
            X_1 \;=\; O + A + F_1,\qquad
            C_1 \;=\; R_0 + S_0,\qquad
            \text{Cons}_1 \;=\; \max(0,\,X_1 - C_1)
          \]
          <p>
            Year-1 donut shows “Consumed” \(=\text{Cons}_1\) and “Remaining” \(=U_0-\text{Cons}_1\).
          </p>

          <p><strong>10-Year (sum of incremental consumption):</strong></p>
          \[
            \text{For } t=1,\dots,10:\quad
            P_t = p\,U,\;\; B_t = c\,P_t,\;\; S_t = \max(0,\,P_t - B_t),\;\; R_t = r\,U
          \]
          \[
            X_t \;=\; A \;+\; \mathbf{1}_{\{t=1\}}\,O \;+\; \mathbf{1}_{\{\text{permFed}\}}\,F,\qquad
            C_t \;=\; R_t + S_t,\qquad
            \text{Cons}_t \;=\; \max(0,\,X_t - C_t)
          \]
          \[
            \text{Cons}_{10} \;=\; \sum_{t=1}^{10}\text{Cons}_t,\qquad
            U \leftarrow \max\!\bigl(0,\; U + R_t - (B_t + X_t)\bigr),\quad
            F \leftarrow F(1+\pi)\; \text{ if permanent}
          \]
          <p>
            10-year donut shows “Consumed” \(=\text{Cons}_{10}\) and “Remaining” \(=U_0-\text{Cons}_{10}\).
          </p>
        </div>
      </div>
    </section>
  </div>

  <!-- Debug badge (kept) -->
  <div id="viz-debug" style="position:fixed;left:10px;bottom:10px;background:#0b142a;border:1px solid #1e293b;color:#e5e7eb;padding:6px 8px;border-radius:8px;font:12px/1.2 system-ui;opacity:.9;z-index:9999">
    Loading D3…
  </div>

  <!-- Robust D3 loader + app boot (kept) -->
  <script>
  (function(){
    var debug = document.getElementById('viz-debug');
    function set(s){ if(debug) debug.textContent = s; }

    var sources = [
      './assets/vendor/d3.v7.min.js',                                             // local copy
      'https://cdnjs.cloudflare.com/ajax/libs/d3/7.9.0/d3.min.js',                // cdnjs
      'https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js',                     // jsdelivr
      'https://unpkg.com/d3@7.9.0/dist/d3.min.js'                                 // unpkg
    ];
    var i = 0;
    function loadNext(){
      if (i >= sources.length){
        set('ERROR: D3 could not be loaded from any source.');
        return;
      }
      var src = sources[i++];
      set('Loading D3: ' + src);
      var s = document.createElement('script');
      s.src = src;
      s.onload = boot;
      s.onerror = loadNext;
      document.head.appendChild(s);
    }
    function boot(){
      if (!window.d3){ loadNext(); return; }
      set('D3 loaded. Booting app…');
      var a = document.createElement('script');
      a.src = './assets/app.js?v=optA6';
      a.onload = function(){ set(window.__VIZ_OK__ ? 'Viz ready ✔' : 'App loaded (no ready flag)'); setTimeout(function(){ if(debug) debug.remove(); }, 1200); };
      a.onerror = function(){ set('ERROR: app.js failed to load.'); };
      document.body.appendChild(a);
    }
    loadNext();
  })();
  </script>

  <!-- MathJax for equations at bottom -->
  <script id="MathJax-script" async
          src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
</body>
</html>
